<!DOCTYPE html>
<html lang="en">
<head>
	<title>Cross-Browser QRCode generator for Javascript</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
	<link rel="icon" href="https://fav.farm/ðŸ¤–" />
	<link rel="stylesheet" href="style.css">
	<script type="text/javascript" src="jquery.min.js"></script>
	<script type="text/javascript" src="qrcode.js"></script>
</head>
<body>
	<header class="site-header">QR Code Generator</header>
	<section class="input">
		<label for="text">QR Code Text</label>
		<input id="text" type="text" value="https://techhigh.us" /><br />
	</section>
	<section class="output">
		<div class="png">
			<h2>PNG</h2>
			<div id="qrcode-png" style="width:100px; height:100px; margin-top:15px;"></div>
			<p class="url"></p>
			<a href="#" id="downloadPNG" class="dwnldbtn" download>Download <svg xmlns="http://www.w3.org/2000/svg" class="downloadAwesome" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path  fill="#2C4251" d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></a>
		</div>
		<div class="svg"> 	
			<h2>SVG</h2>
			<div id="qrcode-svg" style="width:100px; height:100px; margin-top:15px;"></div>
			<p class="url"></p>
			<a href="#" id="downloadSVG" class="dwnldbtn">Download <svg xmlns="http://www.w3.org/2000/svg" class="downloadAwesome" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="#2C4251" d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></a>
		</div>
	</section>
	<footer class="site-footer">
        <a href="https://github.com/jeffhow/qrcodejs" title="Get the code" target="_blank">
            <img src="github-mark-white.png" alt="GitHub Logomark" width="40">
        </a>
		<button id="downloadSVG">Download SVG</button>
    </footer>

	<script type="text/javascript">

	var qrcode_png = new QRCode(document.getElementById("qrcode-png"), {
		width : 100,
		height : 100
	});

	var qrcode_svg = new QRCode(document.getElementById("qrcode-svg"), {
		width : 100,
		height : 100,
		useSVG: true,
	});

	function makeCode () {	
		qrcode_png.clear();
		qrcode_svg.clear();
		var elText = document.getElementById("text");
		document.querySelectorAll('.url').forEach(p=>{
			p.innerText = elText.value;
		})
		
		if (!elText.value) {
			alert("Input a text");
			elText.focus();
			return;
		}
		
		qrcode_png.makeCode(elText.value);
		qrcode_svg.makeCode(elText.value);


		function downloadSVGAsText() {
			const base64doc = btoa(unescape(encodeURIComponent(document.querySelector('svg').outerHTML)));
			const a = document.createElement('a');
			const e = new MouseEvent('click');

			a.download = 'qrcode.svg';
			a.href = 'data:text/html;base64,' + base64doc;
			a.dispatchEvent(e);
		}

		const downloadSVG = document.querySelector('#downloadSVG');
		downloadSVG.addEventListener('click', downloadSVGAsText);

	}
	
	function dl() {
		setTimeout( ()=>{
			let pngSrc = document.querySelector('.png div img').src;
			document.querySelector('#downloadPNG').href=pngSrc;
		},100);
	}

	
	makeCode();
	dl();
	
	$("#text").
	on("blur", function () {
		makeCode();
		dl();
	}).
	on("keydown", function (e) {
		if (e.keyCode == 13) {
				makeCode();
				dl();
			}
		});

		function downloadSVGAsText() {
			const base64doc = btoa(unescape(encodeURIComponent(document.querySelector('svg').outerHTML)));
			const a = document.createElement('a');
			const e = new MouseEvent('click');

			a.download = 'qrcode.svg';
			a.href = 'data:text/html;base64,' + base64doc;
			a.dispatchEvent(e);
		}

		const downloadSVG = document.querySelector('#downloadSVG');
		downloadSVG.addEventListener('click', downloadSVGAsText);
	</script>
</body>
</html>
